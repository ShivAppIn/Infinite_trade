"use strict";(self.webpackChunkweb_rcc_app=self.webpackChunkweb_rcc_app||[]).push([[3687],{73687:(k,f,n)=>{n.r(f),n.d(f,{BannersListingModule:()=>N});var g=n(38583),u=n(39285),y=n(63563),m=n(32401),v=n(80466),L=n(11863),h=n(15844),B=n(4863),t=n(37716),b=n(27632),l=n(3679),C=n(78703),O=n(8008),A=n(54655),T=n(69763),c=n(98295),_=n(49983),p=n(43220),D=n(67441),Z=n(72458);function F(r,d){if(1&r&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&r){const e=d.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.name)}}let S=(()=>{class r extends y.t{constructor(e,i,s,o,a,R,Q){super(),this._bc=e,this._fb=i,this._table=s,this._toast=o,this._banner=a,this._router=R,this._common=Q,this.heading=[{heading:"Banner Title",key:"title",sort:!0,type:"link",link:`/${m.hx}`},{heading:"Banner Used",key:"template",align:"center",type:"formatStatus"},{heading:"Created Date",key:"createdAt",align:"center",type:"date",sort:!0},{heading:"Modified By (Role)",key:"modifiedBy",align:"center"},{heading:"Status",key:"status",align:"center",type:"formatStatus"},{heading:"Action",key:"status",type:"action",action:[1,2,3]}],this.tempList=[],this.status=B.Q_,this.subscriptions=[]}ngOnInit(){this._bc.setBreadcrumb(L._n),this.createForm(),this.permissionHandler(),this.getBannerListing()}createForm(){this.filterForm=this._fb.group({fromDate:[""],toDate:[""],status:[""]})}get f(){return this.filterForm.controls}permissionHandler(){let e=this._common.getPermissionByModuleId(B.rL.BANNERS);(0,h.Z)(e)||(e.add||e.edit||e.delete||e.activeInactive?e.edit||e.delete||e.activeInactive?e.add||e.edit?(e.add||this.removeOnlyAddBtn(),e.edit||this.removeActionOperation(1),e.delete||this.removeActionOperation(3),e.activeInactive||this.removeActionOperation(2)):(this.removeOnlyAddBtn(),this.removeActionOperation(1)):this.removeActionObj():(this.removeOnlyAddBtn(),this.removeActionObj()))}removeOnlyAddBtn(){this.permissionClass=this._common.getClassToRemoveAddBtn()}removeActionObj(){this.heading.splice(this.heading.length-1,1)}removeActionOperation(e){this.heading[this.heading.length-1].action=this.removeAction([e])}removeAction(e){return this.heading[this.heading.length-1].action.filter(i=>!e.includes(i))}selectFromDate(e){this.f.toDate.setValue(null)}getBannerListing(){this._table.tableRender({data:[]})}addBanners(e){this._router.navigate(0==e.id?[`${m.hx}/${m.D7}`]:[`${m.hx}/${m.dm}`,e.data._id])}paginationWithSearch(e,i){switch(i){case 0:this.resetPages(),this.search=e,this.tableRef.paginator&&this.tableRef.paginator.firstPage();break;default:this.pageOptionsOnChange=e}this.getBannerListing()}sortByListing(e){this.sortOptions=e,this.getBannerListing()}changeStatus(e){switch(e.id){case 1:this.addBanners(e);break;default:this.changeBannerStatus(e)}}changeBannerStatus(e){e.action==this.API_EVENT.delete?this.deleteBannerFromList(e):this.activateInactivateBanners(e)}activateInactivateBanners(e){this._banner.activateInactivate({bannerId:e.data._id,status:e.action}).subscribe(s=>{this.showListAfterAction(s)})}deleteBannerFromList(e){this._banner.deleteBanner(e.data._id).subscribe(i=>{e.data.s_no>1&&e.data.s_no%this.limit==1&&1==this.tempList.length&&(this.pageNo=this.pageNo-1,this.tableRef.paginator.pageIndex=this.pageNo-1),this.showListAfterAction(i)})}showListAfterAction(e){this._toast.success(e.message),this.getBannerListing()}filterApply(e){!this.filterForm.dirty||(e.apply?this.filterOptions=this.changeDateFormat(this.filterForm.value):(this.filterOptions=null,this.filterForm.reset()),this.resetPages(),this.tableRef.paginator&&this.tableRef.paginator.firstPage(),this.getBannerListing())}changeDateFormat(e){return e.fromDate&&(e.fromDate=(0,h.Xp)(e.fromDate)),e.toDate&&(e.toDate=(0,h.Xp)(e.toDate,!0)),e}downloadList(e){let i={sortBy:this.validPageOptions.sortBy,sortOrder:this.validPageOptions.sortOrder};this.filterOptions&&(this.filterOptions.status&&(i.status=this.filterOptions.status),this.filterOptions.fromDate&&(i.fromDate=this.filterOptions.fromDate),this.filterOptions.toDate&&(i.toDate=this.filterOptions.toDate)),this.search&&(i.searchKey=this.search),this._banner.exportList(i).subscribe(s=>{s&&s.data&&this._common.redirectToAnotherTab(s.data)})}ngOnDestroy(){this.subscriptions.length>0&&this._common.unsubscribe(this.subscriptions)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(b.p),t.Y36(l.qu),t.Y36(C.w),t.Y36(O.k),t.Y36(u.Q),t.Y36(A.F0),t.Y36(T.v))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-banners-listing"]],viewQuery:function(e,i){if(1&e&&t.Gf(v.S,5),2&e){let s;t.iGM(s=t.CRH())&&(i.tableRef=s.first)}},features:[t._Bn([u.Q]),t.qOj],decls:22,vars:12,consts:[["placeholder","Search by Banner Title",3,"cls","heading","addCustomClass","export","add","find","page","status","sort","filter"],["role","filter"],[1,"filterForm",3,"formGroup"],["appearance","outline"],["matInput","","placeholder","Added From","formControlName","fromDate","readonly","",3,"matDatepicker","max","click","dateChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","placeholder","Added To","formControlName","toDate","readonly","",3,"matDatepicker","max","min","click"],["picker2",""],["appearance","outline",1,"search_filter"],["placeholder","Select Status","formControlName","status"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,i){if(1&e){const s=t.EpF();t.TgZ(0,"mat-table-renderer",0),t.NdJ("export",function(a){return i.downloadList(a)})("add",function(a){return i.addBanners(a)})("find",function(a){return i.paginationWithSearch(a,0)})("page",function(a){return i.paginationWithSearch(a,1)})("status",function(a){return i.changeStatus(a)})("sort",function(a){return i.sortByListing(a)})("filter",function(a){return i.filterApply(a)}),t.TgZ(1,"div",1),t.TgZ(2,"form",2),t.TgZ(3,"mat-label"),t._uU(4,"Added From"),t.qZA(),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"input",4),t.NdJ("click",function(){return t.CHM(s),t.MAs(9).open()})("dateChange",function(a){return i.selectFromDate(a)}),t.qZA(),t._UZ(7,"mat-datepicker-toggle",5),t._UZ(8,"mat-datepicker",null,6),t.qZA(),t.TgZ(10,"mat-label"),t._uU(11,"Added To"),t.qZA(),t.TgZ(12,"mat-form-field",3),t.TgZ(13,"input",7),t.NdJ("click",function(){return t.CHM(s),t.MAs(16).open()}),t.qZA(),t._UZ(14,"mat-datepicker-toggle",5),t._UZ(15,"mat-datepicker",null,8),t.qZA(),t.TgZ(17,"mat-label"),t._uU(18,"Status"),t.qZA(),t.TgZ(19,"mat-form-field",9),t.TgZ(20,"mat-select",10),t.YNc(21,F,2,2,"mat-option",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const s=t.MAs(9),o=t.MAs(16);t.s9C("cls",i.permissionClass),t.Q6J("heading",i.heading)("addCustomClass",""),t.xp6(2),t.Q6J("formGroup",i.filterForm),t.xp6(4),t.Q6J("matDatepicker",s)("max",i.today),t.xp6(1),t.Q6J("for",s),t.xp6(6),t.Q6J("matDatepicker",o)("max",i.today)("min",i.f.fromDate.value),t.xp6(1),t.Q6J("for",o),t.xp6(7),t.Q6J("ngForOf",i.status)}},directives:[v.S,l._Y,l.JL,l.sg,c.hX,c.KE,_.Nt,l.Fj,p.hl,l.JJ,l.u,p.nW,c.R9,p.Mq,D.gD,g.sg,Z.ey],styles:[""]}),r})();var J=n(73478);const M=[{path:"",component:S}];let N=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[g.ez,A.Bz.forChild(M),l.UX,J.g]]}),r})()}}]);